 Satellite Aerosol Retrieval Using Scene Simulation

and Deep Belief Network

Chen Jia ,LinSun , Yunfang Chen, Qinhuo Liu , Senior Member, IEEE , Huiyong Yu, and Wenhua Zhang

Abstract — Aerosol satellite remote sensing retrieval is of great importance in the study of climatic and environmental effects. However, due to varied factors affecting the signals reaching satellite sensors, accurate aerosol retrieval remains challenging. Focusing on limitations in the availability of aerosol data from real scenes, we simulated real scenes to obtain sample data to achieve aerosol retrieval using a deep belief network (DBN). The 6S atmospheric radiative transfer model was used to simulate various possible parameters of earth–atmosphere, sun, and sensor in real scenes. A large amount of simulated data was generated and used as sample datasets of DBN training to obtain the aerosol inversion model. Moderate Resolution Imaging Spectroradiometer (MODIS) data were used to perform aerosol optical thickness (AOT) retrieval experiments. Global-scale aerosol retrieval experiments were conducted based on the following three representative regions: 1) Beijing–Tianjin–Hebei region in China; 2) Midwestern and Southern United States; and 3) Central and Western Euro pe. The retrieval results were verified using Aerosol Robotic Network (AERONET) datasets in comparison with MCD19A2 aerosol products. Five indicators, including mean absolute error (MAE) and within expected error ( f = EE ), were used for the evaluation. The evaluation indicators of the proposed method, in which MAEs were 0.0626, 0.0366, and 0.0487, and f = EE ’s were 86.28%, 85.21%, and 80.71%, performed better than MCD19A2 in three typical regions. The most significant advantage of the proposed method is that high-precision retrieval of spatially continuous AOT can be achieved using single-temporal satellite imagery data, which is not possible realizing in current aerosol retrieval methods.

Index Terms — Aerosol retrieval, deep belief network (DBN), deep learning (DL) algorithm, Moderate Resolution Imaging Spectroradiometer (MODIS), scene simulation.

I. I NTRODUCTION A EROSOLS can change the earth–atmosphere energy bal-ance by directly absorbing and scattering solar radia-tion, thereby affecting global and regional climate [1]–[4]. Furthermore, small-sized aerosol particles can enter the human body and cause harm to health [5], [6]. Aerosols are charac-teristically short-lived and exhibit high variability in time and

Manuscript received June 18, 2021; revised September 6, 2021; accepted September 24, 2021. Date of publi cation October 8, 2021; date of current version January 21, 2022. This work was supported in part by the National Natural Science F oundation of China under Grant 41771408 and in part by the Shandong Provincial Na tural Science Foundation, China under Grant ZR201702210379. (Corresponding author: Lin Sun.)

Chen Jia, Lin Sun, Yunfang Chen, Huiyong Yu, and Wenhua Zhang are with the College of Geodesy and Geomatics, Shandong University of Science and Technology, Qi ngdao, Shandong 266590, China (e-mail: jiachen_1991@163.com; sunlin6@126.com).

Qinhuo Liu is with the State Key Laboratory of Remote Sensing Science, Institute of Remote Sensing and Digital Earth, Chinese Academy of Sciences, Beijing 100101, China (e-mail: liuqh@radi.ac.cn). Digital Object Identifier 10.1109/TGRS.2021.3116154

space [7]–[9]. As such, it is o f great significance to quickly and accurately determine the spa tial distribution of aerosols to study their climatic effects and evaluating their contribution to air pollution.

Satellite remote sensing technology can achieve long-term and large-scale aerosol detec tion, which can play an important role in spatial and temporal distribution studies [10], [11]. With the increase in satellite sensors, research on the remote sensing retrieval of aerosols has developed rapidly [12]. Aerosol opti-cal thickness (AOT), which describes the effect that aerosol on the absorption and scattering of light, is the main retrieval parameter. At present, the main difficulty in aerosol retrieval is the complexity of the influence of the earth’s surface and atmosphere on radiation, which renders sensors unable to provide sufficient information to directly calculate the AOT. To solve this problem, a variety of aerosol retrieval methods have been researched to accurate ly determine surface reflec-tion characteristics to support the AOT retrieval [13], [14]. By considering factors, such as BRDF and land surface reflectance (LSR) to effectivel y separate the influence of sur-face and atmosphere on radiation transmission, these methods realized aerosol remote sensing retrieval [15], [16].

The dark target (DT) algorithm was first proposed and used for AOT retrieval over areas of the ocean, which has very low reflectance in the visible and near -infrared wavelengths [18]. This has been subsequently developed for AOT retrieval in densely vegetated areas using the red and blue bands, which also have low reflectance, and is termed the dense dark vegetation (DDV) method. The accurate determination of LSR is one of the most important steps of this method as, compared to the ocean, vegetated areas ar e more complex and reflectance is relatively high. Nevertheless, the LSR determination of the DDV method has been continuously improved.


1558-0644 © 2021 I EEE. Personal u se is perm itted, but republication/redistri bution requires IEEE permission. See https://www.ieee.org/publications/rights/index.html for more information.

To better identify densely vegetated pixels and determine the LSR of vegetated areas more accurately, Kaufman et al. [20], [21] proposed a method based on the 2.1- μ m, blue, and red bands. This approach is based on the analysis of LSR obtained from satellite and aerial images after atmospheric correction and on reflectance data measured at the surface. This assumes that the band around 2.1 μ mis transparent to aerosols under normal conditions, and therefore, the top of the atmosphere (TOA) reflectance can also be applied as the LSR. At this wavelength, dense vegetation has different reflectance properties to other surface types, with pixels with reflectance values ranging from 0.01 to 0.15 being identified as dense vegetation. LSR in the blue and red bands also has a relatively fixed relationship with the 2.1- μ m band, meaning that it can be predicted to determine the AOT. The accuracy of this method for i dentifying dense vegetation and determining LSR in the red and blue bands has been subsequently improved [22]–[25]. While the DDV method can be used to precisely determine AOT over land, it can only be used in areas with dense, dark vegetation cover. As such, due to the lack of large areas of dense vegetation cover in many parts of the world, aerosol retrieval cannot be realized using this method despite the link between aerosol pollution and human health being strongest in less vegetated areas.

To enable accurate aerosol retrievals for a greater range of surface types, retrieval algorithms for high-reflectance bright areas have been rapidly developed [26]–[29], [60]. The most representative method is the deep blue (DB) algorithm, which is based on the fact that most surface types have low LSR in the blue band and good recognition of aerosols. As such, Hsu et al. [30], [31] proposed a method for AOT retrieval for multiple surface types using the blue band in which reflectivity is determined using datasets generated from existing satellite data. Using SeaWiFS data, this method constructed LSR datasets for the Moderate Resolution Imaging Spectroradiome-ter (MODIS) DB band (0.412 μ m) and obtained the AOT over different land types, including bright areas, such as the Sahara desert. As such, the DB algorithm expands the spatial range of aerosol retrieval and makes the spatial distribution of aerosol more continuous [32].

Based on the DB algorithm, MODIS aerosol products over land with a higher spatial resolution are now avail-able [33], [34]. However, the following factors significantly affect the accuracy and stability of the DB algorithm. First, the determination of LSR is based on existing LSR datasets. As such, during the generation of these datasets, inevitable errors occur in the determined LSR values due to errors in the original atmospheric parameters and the sensor itself. Second, LSR and aerosol data are retriev ed as different types of data. Specifically, there are differences in spatial resolution, band setting, observation time, and geometry, meaning that errors occur during the matching and conversion process. Such errors are subsequently transmitted to the outputs of the aerosol retrieval.

The newly developed Multi-Angle Implementation of Atmospheric Correction (MAIAC) algorithm [35] greatly reduces the problems of AOT retrieval associated with the DB algorithm. This algorithm was developed for aerosol

retrievals and the atmospheric correction of MODIS data, which captures most regions of the earth one-to-two times a day. Based on the assumption that surface properties are relatively stable over short periods, the MAIAC algorithm uses continuous 16-day MODIS data to obtain the surface bidirec-tional reflectance distribution function (BRDF) and spectral regression coefficient (SRC). Using BRDF and SRC data at several wavelengths, aerosol properties are then retrieved from the latest MODIS observations. MAIAC incorporates internal cloud masking [36] and dynamic land–water–snow classification [37] that can accu rately determine LSR for different land types. Because the i nfluence of the bi directional reflection characteristics cause d by differences in observation geometry is considered, aerosol retrieval using this algorithm offers higher accuracy and stability compared to other existing methods, and the results have been used in many applications, including the air quality analysis [38], [39]. The application of this method, which uses continuous 16-day satellite data to retrieve aerosol, is limited nevertheless by its dependence on long time-series datasets, especially for areas with high cloud cover. In addition, in the process of determining LSR, the assumption of surface stability during each 16-day period will also result in some errors for certain areas.

The focus of current aerosol retrieval methods is the accu-rate prediction of LSR. However, because many factors deter-mine LSR, existing methods have some inherent limitations, and this is one of the most important factors limiting the high-precision retrieval of aerosols [40]. The current aerosol retrieval methods mainly rely on the red and blue bands and the shortwave infrared bands near 2.1 μ m, and the red and blue bands are usually used separately. The aerosol information is diversified in satellite sensors, and a large amount of infor-mation has not been applied to aerosol retrieval. Therefore, we believe that the information available from remote sensing datasets is largely insufficient in current methods. Indeed, we suggest that the value of the information provided by remote sensing data is yet to be fully realized.

Although a variety of metrics have been developed for satellite data based on a combination of different wavelengths (e.g., NDVI), the application of satellite data information is still very limited. In recent years, the rapid development of deep learning (DL) technology has, to a large extent, overcome the limitations of human cognition [41]–[43]. DL is a feature learning method based on a multilayer representation that can automatically learn and discover features from raw input data [44]. The approach transforms raw data into higher-level

and more abstract expressions through simple but nonlinear modules. By using sufficient conversions, even very complex function expressions can be learned. Furthermore, based on abundant sample information, DL can extract the spectral, spatial, and other information contained in the data through the learning ability of its algorithms. Thus, DL can generate a sig-nificant amount of information to improve the retrieval preci-sion of environmental and ecological parameters. For example, Ya n et al. [45] and Wei et al. [46] applied different DL models to achieve real-time accurate retr ieval of PM2.5 concentrations from satellite measurement data. DL has shown great power in the recognition and classification of images, audio, and video [47]–[50], and it shows great advantages in the recogni-tion of target attributes in remotely sensed imagery [51]–[53]. It is, however, rarely used for parameter retrieval in quantita-tive remote sensing studies. This is largely due to its demand for large and accurate input datasets, which can be difficult to satisfy in quantitative remote sensing research. Insufficient data or low-accuracy data will limit the application of DL, and in such cases, the superiority of its algorithms cannot be fully exploited. Currently, aerosol retrieval using DL mainly corrects or combines satellite aerosol products to obtain more accurate AOT data [54]–[57]. These methods have not yet fully achieved satellite aerosol retrieval, with accuracy being highly dependent on the accuracy of the chosen product.

To address the problem of the insufficient availability of high-precision samples for aerosol retrieval using DL algo-rithms, here, we propose using scene simulation to support aerosol retrieval using DL. In this approach, the radiative trans-fer model is used to simulate real-world scenes and provide learning data for AOT retrieval using DL. Various possible earth–atmosphere system parameters are simulated using the radiative transfer model and the geometric parameters of the sun and the sensor. These paramet ers provide the training data in the DL process from which multilayer neural networks are used to build an inversion model to enable the quantitative retrieval of aerosol parameters.

II. S CENE S IMULATION AND S AMPLE D ATA A CQUISITION

A large number of representative and high-quality training sample datasets are required to realize the high-precision retrieval of AOT using DL. Possible sample datasets include input and output data, where input refers to the satellite derivative TOA reflectance and observation geometric para-meters under different scene c onditions, and AOT is output. Because of the diversity of factors affecting satellite remote sensing signals, it is difficult to obtain sufficient data from real scenes to generate the training samples required by the DL algorithms. Here, a sufficient number of training samples were obtained by simulating scenes at the surface and the atmosphere. A. Principles of Scene Design

The radiation ( L ) received by satellite sensors with a cloud-free and vertically homogeneous earth–atmosphere system overlying a Lambertian surface can be represented as fol-lows [18], [58]: L (θ s ,θ v ,φ)

= L 0 (θ s ,θ v ,φ) + ρ 1 − ρ S F 0 cos (θ s ) T ↓ (θ s ) T ↑ (θ v ) (1)

where L 0 is the atmospheric path radiation; ρ is the LSR;

S is the atmospheric backscattering ratio; F 0 is TOA radiance density; T ↓ (θ s ) and T ↑ (θ v ) are the atmospheric transmittance along the sun-surface path and surface-sensor path, respec-tively; and θ s , θ v ,and φ are the solar zenith angle, view zenith angle, and relative azimu th angle, respectively.

The nine coefficients in (1) determine the magnitude of the radiant energy reaching the satellite sensor. These nine coefficients are, respectively, related to the reflection charac-teristics of the ground surface, the absorption and scattering

characteristics of the atmosphere, and the observation geome-try of the satellite sensor. Equation (1) is the basis for the sample simulation, and the scene simulation was designed based on this radiative transfer equation. To ensure that the simulation samples are widely r epresentative, for different satellite sensors, all possible distribution ranges of various parameters (including observation geometry parameters, sur-face parameters, atmospheric parameters, and so on) that may affect (1) should be considered. The scene simulation is realized using the 6S radiative transfer model, which can simulate the radiant energy reaching the satellite based on (1) by setting the ground, atmosphere, and observation geometry.

The radiation information obtained by satellite sensors changes depending on the surf ace and atmospheric parameters, and aerosol is one of the influencing factors [59], [60]. Aerosol can, therefore, be extracted by separating the infor-mation about the influence of aerosol on satellite signals. Then, aerosol retrieval can be understood as a regression problem, with satellite radiation information and observation geometric parameters as independent variables and AOT as the dependent variable. However, to meet high-precision retrieval, it is necessary to select effective independent variables and construct sample data that simulates real scenes. Fig. 1 shows the variation in radiation for MODIS bands 1–7 with AOT simulated by the Second Simulation of a Satellite Signal in the Solar Spectrum (6S) radiati ve transfer model. Different atmospheric modes and aerosol models were selected for different LSR conditions and certain geometric angles. This shows that radiation increases with AOT when the LSR is low, while the opposite trend applies when the LSR is high. Compared with bands 5–7, which have longer wavelengths, the radiation signals of bands 1–4 show more distinct changes with changes in the AOT.

Two factors were considered in the selection of wavebands for the construction of sample data, namely, the significance of the aerosol contribution to satellite signals and the high signal-to-noise ratio (SNR). Selecting all bands will cause sample data redundancy, which will affect training efficiency and mining accurate aerosol info rmation. Moreover, the bands of lower SNR will reduce the accuracy of the inversion model. The SNR of MODIS bands 1–7 is, respectively, 128, 201, 243, 228, 74, 275, and 110, where band 6 is the highest. Therefore, bands 1–4, which are more sensitive to aerosol, and band 6, which is less sensitive but has a relatively high SNR, were selected for the aerosol retrieval. The input data included the apparent reflectivity of band 1 (620–670 nm), band 2 (841–876 nm), band 3 (459–479 nm), band 4 (545–565 nm), and band 6 (1628–1652 nm), as well as three observation geo-metric parameters, namely, the satellite zenith angle, the solar zenith angle, and the relative azimuth angle. The AOT data are obtained as the output. The parameters of the simulation scene were designed according to the possible surfaces, atmospheric conditions, and observation geometry.

B. Acquisition of Training Sample Datasets

The 6S radiative transfer model was used for sample data calculation, where 6S was used to simulate the transmission process of solar radiation in the earth–atmosphere system

Fig. 1. Variations in radiance for different MODIS wavebands with increases in the AOT at 550 nm. The abscissa and ordinate are AOT and radiance, respectively, and the different lines represent different LSR conditions. View zenith angle = 20 ◦ , solar zenith angle = 20 ◦ , and relative azimuth = 75 ◦ .

and calculate the radiance of the satellite sensor [61]. This approach can simulate the signal received by the sensor under clear-sky conditions and includes the following parameters: 1) the observation geometric relationship between the sun,

ground objects, and sensors, which is described by the solar zenith angle, solar azimuth angle, observation zenith angle, and observation azimuth angle; 2) the atmospheric model with the basic components and temperature and humidity profiles

TA B L E I P ARAMETER S ETTING OF THE 6S R ADIATIVE T RANSFER M ODEL

defined or the measured sounding data input; 3) the standard aerosol model and some customized models; 4) the spectral response function of the sensor channel; and 5) the LSR. The 6S has high accuracy in radiativ e transfer data simulation; it has been used in the radiation transmission simulation of many types of sensors and plays an important role in data processing, including the retrieval of surf ace and atmospheric parameters and the atmospheric correction of satellite data. Therefore, we used 6S to simulate the radiative transfer process in different scenes, which provided the training samples required for aerosol retrieval.

The systematic sampling method was used to obtain the scenes as training samples. For the aerosol types, different models, such as urban, continental, and others, were selected to ensure that the simulated scene meets the different underlying surfaces and atmospheric conditions. For the atmospheric model, different settings, such as tropical, mid-latitude sum-mer, and midlatitude winter, were selected to ensure that the simulated scene meets different atmospheric conditions. The detailed design of the other relevant parameters of the simulation scene is shown in Table I. Considering storage limitations and computational efficiency, different intervals were set within the range of different parameters to reason-ably express their distributions. The setting of these intervals considers as many different real scenes as possible. For the observation geometry paramet ers, the zenith angle of the sensor was set at 6 ◦ intervals between 1 ◦ and 67 ◦ ; the zenith angle of the sun was set at 10 ◦ intervals between 5 ◦ and 85 ◦ ; and the relative azimuth angle was set at 6 ◦ intervals between 2 ◦ and 178 ◦ . These parameters included all possible observational geometries of the MODIS sensor. Based on the analysis of the reflectance di stribution of a typical surface in the five bands used, the range of LSR values was set to between 0.01 and 0.4 with an interval of 0.01. According to the atmospheric conditions of normal weather, the AOT was set between 0.005 and 2, which was divided into the following four sections: 1) the interval below 0.3 was set as 0.005; 2) the interval between 0.3 and 0.8 was set as 0.01; 3) the interval between 0.8 and 1.2 was set as 0.04; and 4) the interval above 1.2 was set as 0.08. To ensure that the simulated scenes were broadly representative, the design of the parameters accounted for differe nt possible surface conditions, atmospheric conditions, and observation geometries. The joint

probability distribution of the i nput simulation parameters was considered in the simulation p rocess. Different parameters with different values were combined to ensure good represen-tativeness. The construction of the simulated data and training samples fully considered the possible distribution in the real scene. The distribution of the samples was consistent with the actual data, suggesting that the simulated scenes would be unbiased for the training of the models.

The 6S radiative transmission model was used to calculate the TOA reflectance of the five bands in the simulated scene, from which the corresponding sample data were obtained. To ensure the stability of aerosol inversion model training, sample data are randomly divided into a training dataset and a testing dataset. The sample dataset of 8 336 250 lines was obtained through the simulation, with 80% of the sample being randomly selected as the training dataset for the DBN training and the remaining 20% being used as the testing dataset for model verification. The training dataset occupied 80% of sample data and was randomly selected, so it contained all the simulated scenes with broadly representative.

III. N ETWORK C ONSTRUCTION AND M ODEL T RAINING

FOR A EROSOL R ETRIEVAL Neural networks are a means of combining physical and nonparametric statistical models that can establish the implicit relationships between input and output variables. Based on neural networks, DL can operate with a more complex deep network structure and nonlinear transformation algorithm. This approach can realize the hierarchical expression of input information and advanced data mining. Moreover, it can

abstract an accurate expression of the implicit relationships among variables. Here, we sought to make full use of the data-mining capabilities of DL, which uses real scene data simulated by radiative transfer equations as training samples. Aerosol retrieval was regarded as a regression problem, and an appropriate DL regression algorithm was selected to realize it. As such, we investigated the implicit relationships between AOT and other model parameters, represented in the form of a network, and, thus, realized the retrieval of AOT.

A. Deep Belief Network

The emergence of the Boltzmann machine (BM) [62] and the restricted BM (RBM) [63] has greatly accelerated research on multilayer neural networks. The development of deep belief network (DBN) [64] algorithms based on the RBM has further opened up a wave of research on DL. In addition, the contrastive divergence (CD) fast learning algorithm [65] and the greedy layer-wise training method [66] provide a framework for multiple hidden layer models. These methods make DBNs applicable to many aspects of machine learning; DBNs have been used to obtain good results for numerous practical problems, including classification, regression, feature extraction, and dimensionality reduction [67]–[69]. DBN is based on the RBM composition and Bayesian thinking, which can be used to automatically obtain the high-level information hidden in the data that are difficult to interpret, by finding the joint probability distribution of the data. Compared with

Fig. 2. Schematic of the DBN structure.

other DL algorithms, it has unique advantages for applica-tion in complex numerical regression problems. The DBN algorithm also has the advantages of strong learning ability and fast adjustment to adapt to different problems. Therefore, we adopted the DBN regression algorithm to realize remote sensing aerosol retrieval. When training the sample datasets, the DBN regression algorithm was applied to obtain the AOT from satellite radiation information and observation geometric data using a complex network structure. The construction of high-quality sample data (see Section II) ensured that the high-precision model was trained by DBN.

The DBN is a multihidden-layer probability generation model composed of multiple RBMs stacked from bottom to top. The output of each RBM trai ning layer is used as input to the next layer. The network structure is illustrated in Fig. 2. Specifically, the input and output data are the respective input and output layers of the network, and the middle RBMs are hidden layers in the network. The different layers are fully connected, where W i and b i are the weighting and bias of each connection, respectively, and V i and H i ( i = 1 , 2 ,... )are the visible and the hidden layers of each RBM, respectively. The input and output are connected by different hidden layers in the middle, and the calculation from input to output is realized via layer-by-layer transmission of weights and biases. The output data are a predicted value of the DBN, and the target is the corresponding real value. By calculating the loss values between output and target, the network parameters were adjusted and optimized to obtain the best DBN model. When DBN was applied to aerosol retrieval, the input was the TOA reflectance and observation geo metric angles obtained by the satellite sensor, while the output was the AOT to be inverted. AOT retrieval can be realized by the calculation from input to output based on the weight and bias of each connection. The target of this study was the AOT measurement, and the weighting and bias were adjusted by evaluating the difference between the output and the target to obtain the best aerosol inversion model.

The training and learning processes of the DBN method involve two stages, namely, the unsupervised pretraining stage

and the supervised fine-tuning stage [37]. During the unsu-pervised pretraining stage (shown as the bottom-up process in Fig. 2), the unsupervised greedy layerwise algorithm [66] is used to train the parameters of the RBM. During the supervised fine-tuning stage (shown as the top-down process in Fig. 2), the backpropagation (BP) algorithm [70] is applied to adjust and optimize the overall DBN. Thus, the learn-ing process of the DBN can overcome common shortcom-ings, including long training times and only locally optimal solutions.

B. Construction and Training of Network Models

According to the sample data, the input layer of the DBN model had eight neurons, and one neuron was predicted and outputted by the logistic regression layer. The eight neurons of the input layer included the a pparent reflectivity of band 1 (620–670 nm), band 2 (841–876 nm), band 3 (459–479 nm), band 4 (545–565 nm), and band 6 (1628–1652 nm), as well as three observation geometric parameters, namely, the satellite zenith angle, the solar zenith angle, and the relative azimuth angle. The one neuron of the logistic regression layer was AOT. In addition, the structure of the optimal DBN model contained two hidden layers, each with ten neurons. The initial parameters and functions were set as follows: the mean relative error (MRE) was adopted as the loss function to measure the difference between the predicted and target values; the nonlinear sigmoid function [ f ( x ) = 1 /( 1 + e − x ) ] was selected as the activation function, as it improved the capability of the training model in excavating the data information compared to a linear function, and the errors in the training trials were smaller compared to other functions; the training batch size was set to 457 based on a comprehensive consideration of convergence speed, global op timal accuracy, and limited mem-ory capacity of the running platforms. Fig. 3 shows how the training error changed with the number of training iterations. The training error decreased w ith an increase in the number of training iterations, especially for less than 100 iterations; the training error oscillated and decreased slightly when more than 100 iterations were used; and above 600 iterations, the error reduction leveled off and stabilized at the minimum limit. The maximum number of training iterations was, therefore, set to 600.

After the network was constructed and the parameters set, the training data were employed to train the DBN. The weighting and bias of each layer were obtained in the training process, which was saved in the form of a network, and the network structure and r elevant parameters were also saved. As such, the DBN-trained aerosol inversion model was obtained through the combination of this saved information.

Furthermore, verification based on the testing dataset was performed to test the reliability of the resulting aerosol inver-sion model. For this, the AOT retrieval results were compared with the AOT target values of the testing dataset. The MRE and correlation coefficients were 0.3193 and 0.9752 for testing, which was 0.3136 and 0.9769 for training. The testing error was similar to the training error, indicating that there was no overfitting or underfitting in the training process, and the training model had good generalization ability. The high

Fig. 3. Variation in training error with the number of training iterations. The blue line represents variation in the MRE, used to express the training error, and the red line and triangles represent the average of the MREs at 100-iteration intervals.

correlation coefficient was i ndicative of the high accuracy of the retrieval results and the high reliability of the inversion model.

The DBN model obtained by training and testing can be used for practical data to realize aerosol retrieval. AOT was acquired by applying satellite remote sensing data to the model and performing a forward cal culation of the DBN network. The input satellite data corresponded to the input data in the samples, which contained the TOA reflectivity of the selected band and observation geometr ic angle. Compared with the existing aerosol retrieval algorithms that rely on surface reflectance data or long-term time-series data, aerosol retrieval can be achieved using single-temporal satellite imagery data that to be inverted, which reduced data dependence.

IV. D ATA S OURCES AND S TUDY R EGIONS A. Data Sources

1) MODIS Data: The MODIS data, including MOD021KM, MOD03, MCD19A2, and MCD19A1, were applied for AOT retrieval experiments using the DBN-trained model.

The MOD021KM data provided observation geometric parameters and TOA reflectance for aerosol retrieval experi-ments. Simultaneously, MOD03 data provided the geographic location field to assign spatial information to MOD021KM data. MOD021KM is the corrected earth observation data with a resolution of 1 km in the MODIS L1B dataset. It was observed by MODIS sensors mounted on Terra and Aqua satellites of the Earth Observing System (EOS). It has 36 spectral bands, with the electromagnetic spectrum ranging from 0.4 to 14.4 μ m. Due to its full spectrum coverage, from visible light to thermal infrared, it has been applied to remote sensing identification of aerosols, clouds, temper-ature, and land surface coverage . After radiation calibration, the MOD021KM radiation data had a 1-km resolution. The process of radiation calibration r efers to the conversion of the original DN value into the TOA r eflectance, eliminating sensor errors, and obtaining accura te radiation signals.

The MCD19A2 data were used for accuracy compari-son with aerosol retrievals using the DBN-trained model. MCD19A2 is the latest MODIS C6 version of the aerosol product released by NASA, realizing global aerosol moni-toring with high spatial resolution and high time–frequency. It provides daily data at a 1-km pixel resolution. The product contains aerosol parameters, such as blue band AOT at 550 nm, AOT uncertainty, and an AOT model. MCD19A2 uses the MAIAC algorithm, which is based on time-series analysis and a combination of pixel and image-based processing, to perform the aerosol retrieval. In additi on, it provides accurate and stable aerosol spatial coverage for different surface types.

The MCD19A1 data provided the cloud mask for AOT retrieval using the DBN-trained model, to eliminate the influ-ence of clouds on radiation. MCD19A1 is MODIS Terra and Aqua combined MAIAC Land Surface Bidirectional Reflectance Factor (BRF) gridded Level 2 product produced daily at pixel resolutions of 500 m and 1 km. The Status QA dataset of the MCD19A1 data contains the cloud mask of the MAIAC algorithm, which provides cloud masks for MCD19A2 aerosol products. The application of this dataset ensures the consistency of the cloud masks of the DBN-trained model and MCD19A2, thereby ensuring the fairness of the comparison and analysis of the two aerosol retrievals.

2) AERONET Data: The Aerosol Robotic Network (AERONET) ground measurement data was used for the quantitative validation of AOT retrievals. AERONET is a global ground-based aerosol observation network that uses the CIMEL CE318 sun photometer. The reliability of the AERONET AOT data was separated into three quality levels: Level 1.0 (unscreened); Level 1.5 (cloud-screened and quality controlled); and Level 2.0 (quality-assured). Through different quality control, the data accuracy gradually increases with the “Level.” The AERONET Level 2.0 AOT measurement, which has the highest accuracy, was selected to validate the accuracy of the AOT retrievals.

AERONET can provide AOT measurement from the 440-, 675-, 870-, and 1020-nm channels with a time resolution of 15 min. Because AERONET does not provide AOT mea-surements at 550 nm, it was necessary to convert the data. Therefore, the two available channels closest to 550 nm were selected to calculate AOT at 550 nm using the Ångström equations, given by τ(λ 0 ) = βλ − α 0 (2)

α =− ln (τ (λ 1 ) / τ(λ

2 )) ln (λ 1 / λ 2 ) (3)


1

(4)

where τ(λ) is the AOT measurement at λ ; α is the wavelength index; β is Ångström’s turbidity coefficient; λ 0 = 550 nm; and λ 1 and λ 2 are the wavelengths of the two selected channels.

B. Study Regions

Three representative regions, namely, the Beijing–Tianjin– Hebei (BTH) region of China [36–42 ◦ N, 112–121 ◦ E; see Fig. 4(a)], the Midwestern and Southern United States

Fig. 4. Locations of three selected representati ve regions: (a) 2014.08 BTH region of China; (b) 2014. 08 Midwestern and Southern United States; and (c) 2014.05 Central and Western Europe. The red dots are AERONET monitoring sites.

[32–46 ◦ N, 82–96 ◦ W; see Fig. 4(b)], and Central and Western Europe [42–54 ◦ N, 1–13 ◦ E; see Fig. 4(c)] were selected for model validation and AOT retrieval experiments. Fig. 4 shows true-color LSR maps of the three regions. The LSR data were produced by the monthly synthesis of MOD09A1 data, and the data date is labeled in Fig. 4.

The BTH region is located in Eastern China and has a typical warm temperate continental monsoon climate and four distinct seasons. Fuel combustion, industrial waste gas, and traffic exhaust emissions cause serious air pollution in this region, driven by the advanced economy and dense population. At the same time, the diffusion of these pollutants is limited by the regional terrain and the sea-land breeze circulation. However, due to the complex land-surface types and high LSR, aerosol retrieval in the region is difficult, and as such, the BTH region has become a focus for aerosol retrieval research [71].

Central and Western Europe include developed countries, such as Germany, France, Italy, Switzerland, The Netherlands, and Belgium. The region has a temperate maritime climate located in the western part of Eurasia and has the densest population and the most developed industries in the world. Serious environmental pollution occurs, especially in the form of black carbon emissions, which have an important impact on regional and global climates. As the region with the highest concentration of black carbon aer osol in the world, this region is a key research area [72].

The Midwestern and Southern United States faces the Atlantic Ocean to the east and has a complex climate. Air pollution here is serious due to the dense population, especially in the western part of the Great Lakes, which has abundant mineral resources and the earliest industrial development his-tory in the United States. Consequently, aerosol pollution here is particularly serious [73].

MODIS data for the three study regions were obtained for aerosol retrieval and validation, including MOD021KM, MOD03, MCD19A1, and MCD19A2 (see Table II). The acquisition years of these datasets were 2014 for the BTH region of China, 2015 and 2016 for the Midwestern and Southern United States, and 2017 for Central and Western Europe, respectively. There are four AERONET sites in the BTH region of China, eight sites in the Midwestern and

TA B L E I I D ETAILS OF THE MODIS D ATASETS U SED IN T ESTING AND V ALIDATION

Southern United States, and ten sites in Central and Western Europe, a total of 22 sites across the three regions (see Fig. 4).

V. R ESULTS AND D ISCUSSION A. AOT Retrieval Using the DBN-Trained Inversion Model

AOT retrieval experiments were performed based on the DBN-trained aerosol inversion model using MODIS data. To simplify the expression of this article, the aerosol retrievals from the DBN-trained inversion model were abbre-viated as “DBN_AOT,” and the aerosol retrievals of the MCD19A2 product were abbreviated as “MAIAC_AOT” in the following article.

Fig. 5(a) shows the spatial distribution of aerosols on June 19, 2017, over global land areas based on the DBN-trained inversion model and using MOD021KM data. Fig. 5(b) shows the spatial distribution of the global MCD19A2 aerosol product at the corresponding time. As shown, the DBN-trained aerosol inversion model was able to obtain information on the distribution of aerosol not only in vegetated areas but also bright surface areas with high LSR including deserts (such as the Sahara Desert, the North American Desert, a nd the Saudi Arabian Desert) and cities (such as those in Europe and Asia). Based on these results, the DBN_AOT and MAIAC_AOT yielded broadly uniform spatial distributions for different underly-ing land-surface types. From the spatial distribution of the aerosol results, the DBN_AOT has larger spatial coverage than the MAIAC_AOT. In regions such as western and

Fig. 5. AOT spatial distributions derived using (a) DBN_A OT and (b) MAIAC_AOT on June 19, 2017, over global land areas.

northern Canada, eastern Chin a, and the western United States, DBN_AOT has a larger range and more continuous aerosol spatial distribution than MAIAC_AOT. Compared with DBN_AOT, MAIAC_AOT has some missing values in some specific regions and situations. The difference in spatial distri-bution between the two retrievals in Fig. 5 was mostly due to the influence of aerosol retrieval methods. The aerosol retrieval method (MAIAC) of MCD19A2 cannot perform inversion in some specific situations due to its restrictive requirements on long-term series data, which is an inevitable limitation of this method. Some references [74], [75] indi-cate that MCD19A2 requires at least three clear or partially clear days in the Queue to perform inversion, and its cloud filter (“Possfully_Cloudy”) will erase AOT retrievals under cloud-free conditions over areas with high spatial aerosol variability or smoke/dust plumes. Moreover, when B7 band BRF cannot be obtained, the MAIAC algorithm cannot be used to perform retrieval, and the DT algorithm will be applied. However, the DBN-trained aerosol inversion model only relies on single-temporal satellite imagery data that are to be inverted. Therefore, in areas where there is no cloud coverage, the DBN-trained aerosol inversion model can be used to obtain aerosol retrievals.

B. Comparison With the MCD19A2 Aerosol Product

The AOT retrievals of the DBN-trained inversion model were compared with MCD19A2 aerosol products. Repre-sentative AOT images with low cloud cover were selected to compare and analyze the DBN_AOT and MAIAC_AOT. Figs. 6–8 show the AOT spatial distribution for the selected images in three target regions, respectively. The AOT values in the BTH region are usually large owing to the serious air pollution here, which was also confirmed in the validation tests (see Section V-C). As shown in Fig. 6, the spatial distributions of DBN_AOT and MAIAC_AOT were highly consistent irrespective of the AOT values. Furthermore, the MAIAC_AOT showed a large number of missing values, while DBN_AOT had better spatial coverage. The AOT values of DBN_AOT and MAIAC_AOT over the Midwestern and Southern United States and the Central and Western Europe were typically less than 0.5 (see Figs. 7 and 8), which tallied with the validation data (see Section IV-C). However, over high reflectance areas, such as the ice- and the snow-covered Alps, the MAIAC_AOT showed a large number of missing values with poor spatial continuity, whereas the DBN_AOT data provided aerosol information for all areas.

Fig. 6. Comparison of MOD02, DBN_AOT, and MAIAC_AOT over the BTH regio n of China: (a), (d), and (g) are true-color TOA reflectance images; (b), (e), and (h), and (c), (f), and (i) spatial distribution of DBN_AOT and MAIAC_AOT, respectively. The imaging times (month day, year) are shown on the y -axis. The solid lines on the image repr esent the provincial borders of China.

Fig. 7. Comparison of MOD02, DBN_AOT, and MAIAC_AOT over the Midwes tern and Southern United States: (a), (d), and (g) are true-color TOA reflectance images; (b), (e), and (h), and (c), (f), and (i) spatial distribution of DBN_AOT and MAIAC_AOT, respectively. The imaging times (month day , year) are shown on the y-axis. The solid lines on the ima ge represent the state borders of the United States. Fig. 8. Comparison of MOD02, DBN_AOT, and MAIAC_AOT over the Central and Western Europe: (a), (d), and (g) are true-color TOA Reflectance images; (b), (e), and (h), and (c), (f), and (i) spatial distribution of DBN_AOT and MAIAC_AOT, respectively. The imaging times (month day, year) are shown on the y-axis. The solid lines on the image re present the national borders of Europe.

The missing retrievals of MAIAC_AOT were due to the inevitable limitation of its retrieval method, which had been described in Section V-A. Moreover, the official documenta-tion of the MAIAC algorithm showed that, under conditions of very low AOT, nonflat terrain, and generally bright surface, the aerosol retrievals were unreliable at high altitudes. As such, the DBN_AOT provided better spatial continuity and more stable spatial coverage than the MAIAC_AOT.

C. Validation With AERONET Ground Measurements

Quantitative validation of the aerosol retrievals was per-formed using ground measurement data from the AERONET sites. The selection of AERONET sites was introduced in Section IV-B. The time- and s pace-matching principles of AOT retrieval image and AERONET data are given as follows. The AOT measurements at each AERONET site at the MODIS satellite overpass time were taken as the true values. If there were no measurements at this time, the average of at least two AOT measurements within ± 15 min was used. The AOT retrieval results within 5 × 5 pixel sampling windows centered on each AERONET site location were then obtained. 20% of the highest and lowest pixels were discarded to improve reliability, and the average of the remaining values was taken as the retrieved value. Using t hese time- and space-matching methods, real and retrieved AOT value pairs were compared between the DBN_AOT and MAIAC_AOT.

Multiple evaluation indexes were selected to verify the accuracy and reliability of the aerosol retrievals, namely,

the Pearson correlation coefficient ( R ) , relative mean bias (RMB), mean absolute error (MAE), MRE, and root mean square error (RMSE). The expected error (EE) was also selected to analyze the overall distribution between the real and retrieved values. The respective formulas for these indexes are given as follows :

R = ∑ n


i = 1 ( y i − y ) 2

(5)

RMB = 1 n

n ∑

i = 1

x i / y i (6)

MAE = 1 n

n ∑

i = 1

| x i − y i | (7)

MRE = 1 n

n ∑

i = 1 | x i − y i |

y i (8)

RMSE =

√ √ √ √ 1 n

n ∑

i = 1

( x i − y i ) 2 (9)

EE =± ( 0 . 05 + 0 . 2 × y i ). (10)

Table III shows a statistical summary of the validation of the AOT retrievals, where N is the number of AOT pairs obtained and f = EE represents the percentage (%) of AOT retrievals falling within the EE. Fig. 9 shows the evaluation indexes and scatter plots for the AOT pairs. The retrievals for validation

TABLE III S TAT I S T I C A L S UMMARY OF THE V ALIDATION OF AOT R ETRIEVALS O VER T HREE R EPRESENTATIVE R EGIONS AND A LL A REAS

Fig. 9. Scatter plots and validation indexes for AOT retrievals using DBN_AOT and MAIAC_AOT datasets against AERONET AOT measurements: (a) BTH region; (b) Midwestern and Sout hern United States; and (c) Central and Western Europe; t he blue points and purple poi nts represent DBN_AOT and MAIAC_AOT, respectively. The black solid line in each plot represents y = x , and the black dotted lines show the upper and lower limits of the EE error.

were collected by screening the joint results of the two meth-ods. The joint validation refers to the following. According to the time- and space-matching prin ciples, the real and retrieved AOT value matching pairs of two aerosol retrieval methods were obtained; then, the common part of the two sets of AOT point pairs was matched and extracted for verification and analysis. To ensure the objectivity of the verification, no other restrictive conditions were added. The sole purpose of the joint validation was to perform a fair quantitative verification and analysis of the two aerosol retrievals and to comparatively show the distribution of the overestimation and underestimation of the two retrieval methods.

For the BTH region of China with relatively complex surface structure and aerosol sources, 430 AOT pairs were collected in total. Table III and Fig. 9 show that, for the validation of the selected AERONET data and the retrieval results, the DBN-trained inversion model showed notable advantages, and its evaluation indexes performed significantly better compared with the MCD19A2 product. The corre-lation coefficient of the DBN_AOT retrievals was 0.9735, which was higher than that of the MCD19A2 (0.9572). f = EE of the DBN_AOT retrievals (86.28%) was 3.79% higher than that of MCD19A2 (82.79%), with more results falling

within the error limit. The deviation index of the DBN_AOT retrievals was closer to 1 (RMB = 1.0143). The three eval-uation indexes, MAE, MRE, and RMSE, of the DBN_AOT retrievals (MAE = 0.0626, MRE = 0.2780, and RMSE = 0.0886) were smaller than those of the MCD19A2 (MAE = 0.0734, MRE = 0.3357, and RMSE = 0.1094). Overall, the DBN_AOT retrievals had a smaller error, higher accuracy, and greater consistency with the AERONET data than the MCD19A2 product. This proves that the DBN-trained aerosol inversion model had notable advantages over the MCD19A2 product in areas with complex surface structures and complex aerosol sources.

For the other two selected study areas, 1213 AOT pairs between AERONET data and retrievals were collected, includ-ing 622 in the Midwestern and Southern United States and 591 in Central and Western Europe. The retrieval results showed that the AOT in these two areas was generally signif-icantly lower than in the BTH region, and most of the values were below 0.5. In these two areas, the evaluation indexes of the DBN_AOT and the MAIAC_AOT had approximately similar degrees and small differences. Particularly, for f = EE , indicating the stability of the retrievals, the difference was less than 1%. The overall AOT retrieval values were low, making the correlation coefficients verified in these two regions lower than in the BTH region. The correlation coefficients of the two methods were 0.8003 and 0.8291 in the Midwestern and Southern United States and 0.5702 and 0.5901 in Central and Western Europe. The other three evaluation indexes, MAE, MRE, and RMSE, were also relatively close for the AOT retrievals of the two retrieval methods. However, the DBN_AOT (MAE = 0.5362) had a lower average relative error than that of the MAIAC_AOT (MAE = 0.6393) in Central and Western Europe. In addition, the percentages of the results meeting the error limit requirements for the AOT retrievals of the two methods were similar.

For all three regions combined, 1643 effective AOT pairs were analyzed (see Table III). Compared with the MAIAC_AOT ( R = 0.9432, RMB = 1.2827, MAE = 0.0507, MRE = 0.5498, RMSE = 0.0779, and f = EE = 82.71%), the DBN_AOT retrievals had a stronger correlation ( R = 0.9509), an RMB closer to 1 (RMB = 1.2576), smaller errors (MAE = 0.0473, MRE = 0.5025, and RMSE = 0.0693), and more results fell within the error limit ( f = EE = 83.87%). For every validation index, the DBN-trained inver-sion model performed better than the MCD19A2 product. When collecting joint validation AOT pairs, it was found that DBN_AOT obtained more AOT pairs than MAIAC_AOT. The collected DBN_AOT point pair realizes full coverage of the collected MAIAC_AOT point pair, which further proves that the DBN-trained inversion model has more stable spatial coverage than the MCD19A2 product.

The validation results proved that the DBN-trained inversion model performed better than the MCD19A2 product for differ-ent areas. Particularly, in areas where the surface structure and aerosol sources were complex, the MCD19A2 product needs to determine the surface reflectance and assumed aerosol type first, and thus, the accuracy of determination of the surface reflectance and aerosol types was relatively low in these areas. On the contrary, the DBN-trained inversion model does not need to determine the surface reflectance and assumed aerosol type in advance, so it was able to maintain high accuracy in these areas.

VI. C ONCLUSION We have presented a satellite-based aerosol retrieval method using atmospheric scene simulation and DBN and applied this method to MODIS data. The research involves using the 6S model to simulate the atmospheric scene and construct simulation data based on the available satellite parameters and AOT. Considering atmospheric effects and typical surface radiation characteristics, the r elevant parameters in the simu-lation data are then selected to acquire the sample datasets of the DBN. Based on the influence of aerosols and the characteristics of the SNR, TOA reflectances in the B1, B2, B3, B4, and B6 bands are the input data along with the zenith angle, the solar zenith angl e, and the relative azimuth. The target value of output data is AOT ground measurements at a wavelength of 550 nm. The DBN network is trained by the training data to obtain the weighting and bias of each layer. As such, a complete aerosol inversion model is obtained, including parameters, network, weighting, and bias.

The aerosol retrievals for the testing data indicated that the DBN-trained inversion model provides high reliability and accuracy in aerosol retrieval.

To further verify the effectiveness of the new aerosol retrieval method using scene simulation and DBN for satellite aerosol retrieval, three representative regions (the BTH region, Midwestern and Southern United States, and Central and Western Europe) were performed retrieval experiments using MODIS data. The AERONET level 2.0 AOT measurements and MCD19A2 aerosol products for the same areas were also obtained for further validation and comparison. Validation against the AERONET data showed that the AOT retrievals of the new aerosol retrieval method had smaller levels of error and higher accuracy than the MCD19A2 product; the MAE values for the three study areas were 0.0626, 0.0366, and 0.0487, respectively, and f = EE values were 86.28%, 85.21%, and 80.71%, respectively. Esp ecially, for the BTH area, where the surface structure and aerosol sources were complex, com-pared with evaluation indexes of the MCD19A2 product ( R = 0.9572, RMB = 1.1731, MAE = 0.734, MRE = 0.3357, RMSE = 0.1094, and f = EE = 82.79%), the new aerosol retrieval method ( R = 0.9735, RMB = 1.0143, MAE = 0.626, MRE = 0.2780, RMSE = 0.0886, and f = EE = 86.28%) performed significantly better. Crucially, the new retrieval method produced more accurate AOT retrievals than the MCD19A2 product. Furthermore, the regional scale compar-isons indicated that the new model has more stable spatial coverage and spatial continuity than the MCD19A2 product, especially in areas with high reflectivity values.

In comparison with the current aerosol retrieval methods, which requires LSR or long-term time-series satellite data, the aerosol retrieval method using scene simulation and DBN can achieve highly accurate retrievals based on single-temporal satellite imagery data that to be inverted, which reduces data dependence. Moreover, it can provide high-precision, stable, and reliable aerosol spatial distribution information for areas with different atmospheric modes, aerosol types, and surface-cover types. As such, the proposed aerosol retrieval method is of significance for a range of applications, including quantitative aerosol retrieval and air pollution monitoring.

A CKNOWLEDGMENT The authors thank NASA (https://www.nasa.gov/) for providing Moderate Resolution Imaging Spectroradiome-ter (MODIS) data and Aerosol Robotic Network (AERONET) (https://aeronet.gsfc.nasa.gov/) for providing aerosol ground-based observation data. Chen Jia designed and carried out the research and wrote the initial draft. Lin Sun, Yunfang Chen, and Qinhuo Liu helped review and edit this article. Huiyong Yu and Wenhua Zhang performed the data processing and validation. All authors contributed to the interpretation of the results.